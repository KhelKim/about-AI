# Accuracy, Precision, Recall, F1

[TOC]

## Introduction

우리가 classification 모델의 성능을 측정하고 싶을 때 자주 사용하는 지표는 accuracy, 정확도이다. 만약 개의 사진 50개와 고양이 사진 50개가 있고 이를 모델에게 예측하게 했다고 가정하자. 모델이 사진 100개를 예측해서 개는 개, 고양이는 고양이라고 맞춘 개수가 80개라고 한다면 이 모델의 정확도는 80% 혹은 0.8이라고 말한다. 즉, accuracy는

- $\frac{맞은 개수}{전체 개수}$

이다. 이를 모델의 성능 지표로 사용하는 것은 직관적이고 합리적이게 생각될 수 있다.

이러한 문제에서 모델의 정확도가 만약 1/2라면 이 모델은 사진이 어떤 것이든 동전을 던져서 앞면이 나오면 개, 뒷면이 나오면 고양이라고 예측하는 모델과 다를 바 없다.

 하지만 개의 사진이 90개, 고양이의 사진이 10개 있는 데이터 셋을 생각해보자. 우리의 모델이 1) 동전을 사용하는 모델과 똑같다면 모델의 정확도는 여전히 0.5일 것이다. 하지만 우리의 모델이 2) 개만을 출력하는 모델이어서 어떠한 사진이 들어오든 개라고만 답한다면 이 모델의 정확도는 0.9일 것이다. 이 모델은 상태가 좋은 것 같지 않지만 어쨋든 정확도는 높은 상황이다. 과연 1) 모델이 좋은 것일까, 2) 모델이 좋은 것일까?

사실, 모델 1)이 좋을 지 모델 2)가 좋을 지는 문제에 따라 달라진다.

예를 들어

1. 모델 1)이 모델 2)보다 나은 경우

    예를 들어, 범죄자를 판단하는 모델이 있다고 해보자. 그리고 우리는 무죄추정의 원칙을 지치는 나라라고 생각해보자. 모델이 판단해야하는 사람들은 100명이 있고 이 사이에는 90명의 범죄자와 10명의 무고한 사람이 있다면, 

    모델 1)은 45명 정도의 범죄자를 놓칠 수는 있지만 약 5명의 무고한 사람을 감옥에 넣지 않을 것이다.

    한편 모델 2)는 무고한 사람 10명까지 무조건 감옥에 넣어버릴 것이다.

    우리가 무죄추정의 원칙을 지키는 나라라면 비록 정확도는 떨어지지만 모델 2)보다는 모델 1)을 사용할 것이다.

2. 모델 2)가 모델 1)보다 나은 경우

    예를 들어, 환자의 불치평 양성, 음성 판단 모델이 있다고 생각해보자. 모델이 판단해야하는 사람들은 100명이 있고, 이 사이에는 90명의 양성 환자와, 10명의 음성 환자가 있다고 하자.

    모델 1)은 45명 정도의 양성 환자에게 음성이라는 판단을 할 것이고, 5명의 음성 환자에게 양성이라는 판단을 할 것이다.

    모델 2)는 100명 모두에게 양성이라는 판단을 할 것이다.

    모델 1)의 경우에는 45명 정도의 양성환자가 치료를 받아야하는 지도 모르고 죽을 것이다. 

    모델 2)의 경우에는 10명의 음성 환자가 쓸 모 없는 치료비를 지출하지만 양성 환자 90명은 무조건 적절한 치료를 받을 수 있다.

    이 경우에는 모델 2)가 모델 1)보다는 나은 상황이라고 할 수 있다.

이 처럼 우리는 문제에 따라 정확도가 절대적 지표가 될 수 없다는 것을 알게 되었다. 이러한 각각의 문제에 따라 적절한 지표가 있는데, accuracy 정확도, precision 정밀도, recall 재현율, F1 score가 있다.

## Confusion Matrix

후에 나올 정의를 위해 먼저 confusion matrix에 대해 알고 가면 좋다. 책마다 표현하는 방식이 두가지 있다.

1. 

|              | 모델의 예측: class1 | 모델의 예측: class2 |
| ------------ | ------------------- | ------------------- |
| 실제: class1 |                     |                     |
| 실제: class2 |                     |                     |

2. 

|                     | 실제: class1 | 실제: class2 |
| ------------------- | ------------ | ------------ |
| 모델의 예측: class1 |              |              |
| 모델의 예측: class2 |              |              |

인터넷을 찾다보면, 1번처럼 표현된 matrix로 많고, 2번처럼 표현된 matrix도 많다. 우리는 1번의 표현방식을 사용하자.

ex1)

개 50, 고양이 50, 모델: 랜덤

|              | 모델의 예측: 개 | 모델의 예측: 고양이 |
| ------------ | --------------- | ------------------- |
| 실제: 개     | 25              | 25                  |
| 실제: 고양이 | 25              | 25                  |

ex2)

개 90, 고양이 10, 모델: 랜덤

|              | 모델의 예측: 개 | 모델의 예측: 고양이 |
| ------------ | --------------- | ------------------- |
| 실제: 개     | 45              | 45                  |
| 실제: 고양이 | 5               | 5                   |

ex3)

개 90, 고양이 10, 모델: 개 모델

|              | 모델의 예측: 개 | 모델의 예측: 고양이 |
| ------------ | --------------- | ------------------- |
| 실제: 개     | 90              | 0                   |
| 실제: 고양이 | 10              | 0                   |

## Accuracy

$accuracy=\frac{맞춘개수}{전체개수}$ 이다.

ex1)'s accuracy = $\frac{25 + 25}{100}$

ex2)'s accuracy = $\frac{45 + 5}{100}$

ex3)'s accuracy = $\frac{90 + 0}{100}$

정확도는 introduction에서 말한듯, 전체 개수에서 맞은 개수의 비율이다.

## Precision

Precision, 정밀도는 class 별로 정의 된다.

- $\text{class1's precision} = \frac{\text{모델이 class1이라고 예측한 것 중 실제로 class1인 것의 개수}}{\text{모델이 class1이라고 예측한 것의 개수}}$

ex1) class1's precision $= \frac{25}{25 + 25}$ 



ex2) class1's precision $= \frac{45}{45 + 5} $

ex2) class2's precision $= \frac{5}{45 + 5}$



ex3) class1's precision $= \frac{90}{90 + 10}$

ex3) class2's precision $= \frac{0}{0 + 0}$ (분모가 0인 경우 0으로 대체한다)

- Problem

    class1: 범죄자, class2: 무고한 사람, 혹은

    class1: 양성환자, class2: 음성환자

    라고 생각해보자!

## Recall

Recall, 재현율은 class 별로 정의 된다.

- $\text{class1's recall} = \frac{\text{실제 class1인 것 중 모델이 class1이라고 예측한 것의 개수}}{\text{실제 class1인 것의 개수}}$

ex1) class1's recall $= \frac{25}{25 + 25}$ 



ex2) class1's recall $= \frac{45}{45 + 45} $

ex2) class2's recall $= \frac{5}{5 + 5}$



ex3) class1's recall $= \frac{90}{90 + 0}$

ex3) class2's recall $= \frac{0}{10 + 0}$ 

- Problem

    class1: 범죄자, class2: 무고한 사람, 혹은

    class1: 양성환자, class2: 음성환자

    라고 생각해보자!

## F1 score

introduction 챕터의 예시의 상황들을 가정하면 각각 특정 class의 precision이 판단의 근거가 될 때와, recall이 판단의 근거가 될 때의 장단점이 보일 것이다. 수학적으로도 precision과 recall은 반비례 관계를 갖는다.

만약 우리 모델에서 precision과 recall을 둘 다 포기할 수 없을 땐 어떻게 해야할까. 이때 precision과 recall의 조화평균인 f1 score을 사용하게 된다.

- $f1\_score = \frac{1}{\frac{1}{2}({\frac{1}{precision} + \frac{1}{recall}})}$



